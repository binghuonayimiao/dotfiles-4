#!/usr/bin/env bash
# ============================================================================= #
#  ➜ ➜ ➜ TRAP
# ============================================================================= #
trap 'exit' SIGINT SIGQUIT SIGTSTP

if [ ! -f "lib/utilities.sh" ]; then
    git submodule --quiet sync --recursive
    git submodule --quiet update --init --recursive
fi
cd lib || exit 1
git checkout master
git pull origin master
cd ..

source "lib/utilities.sh"

prepare_env() {

    TITLE "Device:"
    CUTLINE
    BOLDBLUE "$DISTRO | $UARCH | $UKERNEL"
    CUTLINE

}

main() {
    prepare_env

    TITLE "Running auto install"
    CUTLINE
    if [ ! -t 0 ]; then
        ./bin/dosync -unanttended
    else
        ./bin/dosync
    fi
    CUTLINE
    exec "zsh"
    exit 0
}
while true; do
    main "$@"
done
